# 1. 介绍

HTTP 通常用于分布式信息系统，通过缓存响应可以提高性能。本文档定义了 HTTP/1.1 中与缓存和重用响应报文有关的方面。

HTTP 缓存是响应报文的本地存储，以及控制本地存储中报文的存储、检索和删除的子系统。缓存储存了可缓存的响应，以减少未来同等请求的响应时间和网络带宽消耗。任何客户或服务器都 **可以** 使用缓存，尽管缓存不能由作为隧道的服务器使用。

**共享缓存(shared caches)** 储存的响应可以被一个以上的用户重用；共享缓存通常（但不总是）部署为中继的一部分。与此相反，**私有缓存(private caches)** 是专门为单个用户准备的；通常，它们被部署为用户代理的一个组成部分。

HTTP/1.1 中缓存的目标是通过重用先前的响应报文来满足当前的请求，从而显著提高性能。按照第 4.2 节的定义，如果一个被储存的响应可以在不进行验证（与源服务器进行检查，看被缓存的响应对这个请求是否有效）的情况下被重用，那么该响应就被认为是 “新鲜的”。因此，新鲜的响应在每次重用时可以减少延迟和网络开销。当被缓存的响应不新鲜时，如果可以通过验证（第 4.3 节）来刷新（或者源服务器不可用（第 4.2.4 节）），它仍然可以被重用。

## 1.1. 符合性和错误处理

本文档中的关键词 “必须”、“不得”、“需要”、“应当”、“不应当”、“应该”、“不应该”、“推荐”、“可以” 和 “可选” 应按照[RFC 2119]中的描述进行解释。

有关错误处理的符合性标准和注意事项在[RFC 7230] 第 2.5 节中定义。

## 1.2. 语法记号

本规范使用[RFC 5234]的 Augmented Backus-Naur Form（ABNF）符号，并在[RFC 7230]的第 7 节中定义了一个列表扩展，允许使用'#'操作符（类似于'\*'操作符表示重复的方式）紧凑地定义逗号分隔的列表。附录 C 描述了从其他文件中导入的规则。附录 D 显示了收集到的语法，其中所有的列表操作符都扩展为标准的 ABNF 符号。

### 1.2.1. delta seconds

delta-seconds 规则指定一个非负的整数，代表以秒为单位的时间。

```abnf
delta-seconds = 1*DIGIT
```

一个接收者在解析 delta-seconds 值并将其转换为二进制形式时，应该使用至少 31 位的非负整数范围的算术类型。如果缓存收到的 delta-seconds 值大于它能表示的最大整数，或者如果它的任何后续计算溢出，缓存 **必须** 认为该值是 2147483648（2^31）或者它能方便表示的最大正整数。

注意：2147483648 这个值在这里是出于历史原因，有效地代表了无穷大（超过 68 年），而且不需要以二进制形式存储；如果发生任何溢出，一个实现可以把它作为一个罐头字符串产生，即使计算是用一个不能直接表示这个数字的算术类型进行的。 这里重要的是，溢出被检测到，并且在以后的计算中不被当作负值。

# 2. 缓存运作概述

合适的缓存运作保留了 HTTP 传输的语义（[RFC7231]），同时消除了已经保存在缓存中的信息的传输。尽管缓存是 HTTP 的一个完全 **可选** 的功能，但重用缓存响应被假设是需要的，当没有要求或本地配置防止缓存时，这种重用是默认行为。因此，HTTP 缓存的规定集中在防止缓存储存不可重用的响应或者防止不适当地重用被存储的响应，而不是强制要求缓存总是存储和重用特定的响应。

每个缓存条目由一个缓存密钥和一个或多个对应于使用相同密钥的先前请求的 HTTP 响应组成。最常见的缓存条目形式是检索请求的成功结果：即对 GET 请求的 200（OK）响应，其中包含请求目标所确定的资源的表示（[RFC7231]的 4.3.1 节）。然而，如果方法的定义允许这种缓存并定义了适合作为缓存键的东西，那么也可以缓存永久重定向、负面结果（例如 404（Not Found））、不完整结果（例如 206（Partial Content））以及对 GET 以外的方法的响应。

主要的缓冲键由请求方法和目标 URI 组成。然而，由于现在普遍使用的 HTTP 缓存通常只限于缓存 GET 的响应，许多缓存只是拒绝其他方法，只使用 URI 作为主要的缓存密钥。

如果一个请求目标受制于内容协商，它的缓存条目可能由多个存储的响应组成，每个响应都由原始请求的选择头字段的值的二级键来区分（第 4.1 节）。
